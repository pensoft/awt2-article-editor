let externalRefs = [
  {
    "source": "DataCite",
    "authors": [
      [
        "Tom",
        "Staton"
      ]
    ],
    "doi": "10.17632/rjf86nv3n6.2",
    "href": "http://dx.doi.org/10.17632/rjf86nv3n6.2",
    "title": "Cereal and apple yield data from agroforestry and monoculture systems in the UK, 2018-2020",
    "year": 2022,
    "publicationDate": null,
    "publishedIn": "Mendeley",
    "firstauthor": [
      "Tom",
      "Staton"
    ],
    "isParsed": true,
    "related": [
      {
        "value": "10.17632/rjf86nv3n6",
        "relation": "IsVersionOf",
        "idType": "DOI"
      }
    ],
    "type": "Dataset"
  },
  {
    "source": "DataCite",
    "authors": [
      [
        "Tom",
        "Staton"
      ]
    ],
    "doi": "10.17632/rjf86nv3n6",
    "href": "http://dx.doi.org/10.17632/rjf86nv3n6",
    "title": "Cereal and apple yield data from agroforestry and monoculture systems in the UK, 2018-2020",
    "year": 2022,
    "publicationDate": null,
    "publishedIn": "Mendeley",
    "firstauthor": [
      "Tom",
      "Staton"
    ],
    "isParsed": true,
    "related": [
      {
        "value": "10.17632/rjf86nv3n6.1",
        "relation": "HasVersion",
        "idType": "DOI"
      }
    ],
    "type": "Dataset"
  },
  {
    "source": "DataCite",
    "authors": [
      [
        "Kenneth D.",
        "Pimple"
      ]
    ],
    "doi": "10.25675/10217/176331",
    "href": "http://dx.doi.org/10.25675/10217/176331",
    "title": "Routine activity theory and research ethics: a criminological approach",
    "year": 2016,
    "publicationDate": null,
    "publishedIn": "Mountain Scholar",
    "firstauthor": [
      "Kenneth D.",
      "Pimple"
    ],
    "isParsed": true,
    "related": [],
    "type": "Text"
  }
]

let mappedRefs = [
  {
    "ref": {
      "author": [
        {
          "family": "Tom",
          "given": "Staton"
        },
        {
          "family": "T",
          "given": "o"
        },
        {
          "family": "S",
          "given": "t"
        }
      ],
      "DOI": "10.17632/rjf86nv3n6.2",
      "URL": "http://dx.doi.org/10.17632/rjf86nv3n6.2",
      "title": "Cereal and apple yield data from agroforestry and monoculture systems in the UK, 2018-2020",
      "issued": {
        "date-parts": [
          [
            "2022",
            "1",
            "1"
          ]
        ]
      },
      "city": "Mendeley",
      "type": "dataset"
    },
    "formIOData": {
      "authors": [
        {
          "first": "Tom",
          "last": "Staton",
          "name": "",
          "role": "author",
          "type": "person"
        },
        {
          "first": "T",
          "last": "o",
          "name": "",
          "role": "author",
          "type": "person"
        },
        {
          "first": "S",
          "last": "t",
          "name": "",
          "role": "author",
          "type": "person"
        }
      ],
      "DOI": "10.17632/rjf86nv3n6.2",
      "URL": "http://dx.doi.org/10.17632/rjf86nv3n6.2",
      "title": "Cereal and apple yield data from agroforestry and monoculture systems in the UK, 2018-2020",
      "issued": "2022",
      "city": "Mendeley"
    },

  }, {
    "ref": {
      "author": [
        {
          "family": "Tom",
          "given": "Staton"
        },
        {
          "family": "T",
          "given": "o"
        },
        {
          "family": "S",
          "given": "t"
        }
      ],
      "DOI": "10.17632/rjf86nv3n6",
      "URL": "http://dx.doi.org/10.17632/rjf86nv3n6",
      "title": "Cereal and apple yield data from agroforestry and monoculture systems in the UK, 2018-2020",
      "issued": {
        "date-parts": [
          [
            "2022",
            "1",
            "1"
          ]
        ]
      },
      "city": "Mendeley",
      "type": "dataset"
    },
    "formIOData": {
      "authors": [
        {
          "first": "Tom",
          "last": "Staton",
          "name": "",
          "role": "author",
          "type": "person"
        },
        {
          "first": "T",
          "last": "o",
          "name": "",
          "role": "author",
          "type": "person"
        },
        {
          "first": "S",
          "last": "t",
          "name": "",
          "role": "author",
          "type": "person"
        }
      ],
      "DOI": "10.17632/rjf86nv3n6",
      "URL": "http://dx.doi.org/10.17632/rjf86nv3n6",
      "title": "Cereal and apple yield data from agroforestry and monoculture systems in the UK, 2018-2020",
      "issued": "2022",
      "city": "Mendeley"
    }
  },
  {
    "ref": {
      "author": [
        {
          "family": "Kenneth D.",
          "given": "Pimple"
        },
        {
          "family": "K",
          "given": "e"
        },
        {
          "family": "P",
          "given": "i"
        }
      ],
      "DOI": "10.25675/10217/176331",
      "URL": "http://dx.doi.org/10.25675/10217/176331",
      "title": "Routine activity theory and research ethics: a criminological approach",
      "issued": {
        "date-parts": [
          [
            "2016",
            "1",
            "1"
          ]
        ]
      },
      "city": "Mountain Scholar",
      "type": "text"
    },
    "formIOData": {
      "authors": [
        {
          "first": "Kenneth D.",
          "last": "Pimple",
          "name": "",
          "role": "author",
          "type": "person"
        },
        {
          "first": "K",
          "last": "e",
          "name": "",
          "role": "author",
          "type": "person"
        },
        {
          "first": "P",
          "last": "i",
          "name": "",
          "role": "author",
          "type": "person"
        }
      ],
      "DOI": "10.25675/10217/176331",
      "URL": "http://dx.doi.org/10.25675/10217/176331",
      "title": "Routine activity theory and research ethics: a criminological approach",
      "issued": "2016",
      "city": "Mountain Scholar"
    }
  }
]

let mappingObj = {
  "doi": { type: ['string'], cslProp: 'DOI', formIOprop: "DOI" },
  "href": { type: ['string'], cslProp: 'URL', formIOprop: "URL" },
  "title": { type: ['string'], cslProp: 'title', formIOprop: "title" },
  "year": {
    type: ['string', 'number'],
    cslProp: {
      prop: 'issued', func: `(function a(year,refobj,formioobj,extRef){
        if(!year) return
        let val = year.toString();
        let dateParts = val.split('-')
        if (dateParts.length == 1) {
          dateParts.push('1')
          dateParts.push('1')
        }
        if (dateParts.length == 2) {
          dateParts.push('1')
        }
        refobj['issued'] = {
          "date-parts": [
            dateParts
          ]
        }
    })` },
    formIOprop: {
      prop: 'issued', func: `(function a(year,refobj,formioobj,extRef){
        if(!year) return
        let val = year.toString();
      formioobj['issued'] = val
    })` },
  },
  "publicationDate": {
    type: ['string', 'number'],
    cslProp: {
      prop: 'issued', func: `(function a(year,refobj,formioobj,extRef){
        if(!year) return
        let val = year.toString();
        let dateParts = val.split('-')
        if (dateParts.length == 1) {
          dateParts.push('1')
          dateParts.push('1')
        }
        if (dateParts.length == 2) {
          dateParts.push('1')
        }
        refobj['issued'] = {
          "date-parts": [
            dateParts
          ]
        }
    })` },
    formIOprop: {
      prop: 'issued', func: `(function a(year,refobj,formioobj,extRef){
        if(!year) return
        let val = year.toString();
        formioobj['issued'] = val
    })` },
  },
  "publishedIn": { type: 'string', cslProp: 'city', formIOprop: "city" },
  "firstauthor": {
    type: ['string[][]'],
    cslProp: {
      prop: 'author', func: `(function a(firstauthor,refobj,formioobj,exterRef){
      if (!refobj['author']) {
        refobj['author'] = []
      }
      firstauthor.forEach((author) => {
        if (author && (author[0] || author[1])) {
          refobj['author'].push({ "family": author[0] ? author[0] : '', "given": author[1] ? author[1] : '' })
        }
      })
    })` },
    formIOprop: {
      prop: 'authors', func: `(function a(firstauthor,refobj,formioobj,exterRef){
      if (!formioobj['authors']) {
        formioobj['authors'] = []
      }
      firstauthor.forEach((author) => {
        if (author && (author[0] || author[1])) {
          formioobj['authors'].push({
            "first": author[0] ? author[0] : '',
            "last": author[1] ? author[1] : '',
            "name": "",
            "role": "author",
            "type": "person"
          })
        }
      })
    })` },
  },
  "isParsed": undefined,
  "type": {
    type: 'string', cslProp: {
      prop: 'type', func: `(function a(type,refobj,formioobj,extRef){
        if (type) {
          maped['type'] = type.replace(' ', '-').toLocaleLowerCase()
        } else {
          maped['type'] = 'article-journal'
        }
  })` }
  },
  "volume": { type: 'string', cslProp: 'volume', formIOprop: "volume" },
  "spage": {
    type: ['string', 'number'],
    cslProp: {
      prop: 'page', func: `(function a(spage,refobj,formioobj,exterRef){
      if(!refobj['page']){
        refobj['page'] = spage
      }else{
        refobj['page'] = spage+"-"+refobj['page']
      }
    })` },
    formIOprop: {
      prop: 'page', func: `(function a(spage,refobj,formioobj,exterRef){
      if(!formioobj['page']){
        formioobj['page'] = spage
      }else{
        formioobj['page'] = spage+"-"+formioobj['page']
      }
    })` },
  },
  "epage": {
    type: ['string', 'number'],
    cslProp: {
      prop: 'page', func: `(function a(epage,refobj,formioobj,exterRef){
      if(!refobj['page']){
        refobj['page'] = epage
      }else{
        refobj['page'] = refobj['page']+"-"+epage
      }
    })` },
    formIOprop: {
      prop: 'page', func: `(function a(epage,refobj,formioobj,exterRef){
      if(!formioobj['page']){
        formioobj['page'] = epage
      }else{
        formioobj['page'] =formioobj['page']+"-"+epage
      }
    })` },
  },
  "id": {
    type: ['string', 'object'],
    cslProp: {
      prop: 'id', func: `(function a(id,refobj,formioobj,exterRef){
      if (typeof ref.id == 'string') {
        return ref.id
      } else if (typeof ref.id == 'object') {
        return Object.values(ref.id).join(':SePaRaToR:')
      } else {
        return undefined
      }
    })` },
  },
  "infoUrl": undefined,
  "abstract": { type: 'string', cslProp: 'abstract', formIOprop: "abstract" },
  "fullCitation": undefined,
  "score": undefined,
  "authors": {
    type: ['string[][]'],
    cslProp: {
      prop: 'author', func: `(function a(authors,refobj,formioobj,exterRef){
      if (!refobj['author']) {
        refobj['author'] = []
      }
      authors.forEach((author) => {
        if (author && (author[0] || author[1])) {
          refobj['author'].push({ "family": author[0] ? author[0] : '', "given": author[1] ? author[1] : '' })
        }
      })
    })` },
    formIOprop: {
      prop: 'authors', func: `(function a(authors,refobj,formioobj,exterRef){
      if (!formioobj['author']) {
        formioobj['authors'] = []
      }
      authors.forEach((author) => {
        if (author && (author[0] || author[1])) {
          formioobj['authors'].push({
            "first": author[0] ? author[0] : '',
            "last": author[1] ? author[1] : '',
            "name": "",
            "role": "author",
            "type": "person"
          })
        }
      })
    })` },
  },
  "related": undefined,
  "source": undefined,
  "issue": { type: 'string', cslProp: 'issue', formIOprop: "issue" },
}
